name: Create git tag
on: 
  push:
    branches: 
      - main
  workflow_dispatch:
jobs:
  Build-Code:
    permissions:
      contents: write
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
      with:
        fetch-depth: 0
    - name: Install GitVersion
      uses: gittools/actions/gitversion/setup@v1.0.0
      with:
        versionSpec: '5.x'
    - name: Determine Version
      uses: gittools/actions/gitversion/execute@v1.0.0
      with:
        useConfigFile: true
    - name: Create Release
      id: create_release
      uses: actions/create-release@v1
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} # This token is provided by Actions, you do not need to create your own token
      with:
        tag_name: ${{ env.GitVersion_MajorMinorPatch }}
        release_name: Release ${{ env.GitVersion_MajorMinorPatch }}
        body: |
          Changes in this Release
          - First Change
          - Second Change
        draft: false
        prerelease: false
    # - name: Create git tag
    #   run: |
    #     git tag ${{ env.GitVersion_MajorMinorPatch }}
    #   if: github.ref == 'refs/heads/main'
    - name: Push git tag
      run: git push origin ${{ env.GitVersion_MajorMinorPatch }}
    #   if: github.ref == 'refs/heads/main'